{"dependencies":[{"name":"./Updates","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":37,"index":37}}],"key":"dHmtn1izBCeSkZ/2BgK9eSyi8a8=","exportNames":["*"],"imports":1}},{"name":"./UseUpdates.types","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":38},"end":{"line":2,"column":52,"index":90}}],"key":"c/0dTIDFMt3vtNcWYCgpJC9RQHM=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"currentlyRunning\", {\n    enumerable: true,\n    get: function () {\n      return currentlyRunning;\n    }\n  });\n  Object.defineProperty(exports, \"updateFromManifest\", {\n    enumerable: true,\n    get: function () {\n      return updateFromManifest;\n    }\n  });\n  Object.defineProperty(exports, \"updateFromRollback\", {\n    enumerable: true,\n    get: function () {\n      return updateFromRollback;\n    }\n  });\n  Object.defineProperty(exports, \"defaultUseUpdatesState\", {\n    enumerable: true,\n    get: function () {\n      return defaultUseUpdatesState;\n    }\n  });\n  Object.defineProperty(exports, \"reduceUpdatesStateFromContext\", {\n    enumerable: true,\n    get: function () {\n      return reduceUpdatesStateFromContext;\n    }\n  });\n  var _Updates = require(_dependencyMap[0], \"./Updates\");\n  var Updates = _interopNamespace(_Updates);\n  var _UseUpdatesTypes = require(_dependencyMap[1], \"./UseUpdates.types\");\n  // The currently running info, constructed from Updates constants\n  var currentlyRunning = {\n    updateId: Updates.updateId ?? undefined,\n    channel: Updates.channel ?? undefined,\n    createdAt: Updates.createdAt ?? undefined,\n    isEmbeddedLaunch: Updates.isEmbeddedLaunch,\n    isEmergencyLaunch: Updates.isEmergencyLaunch,\n    emergencyLaunchReason: Updates.emergencyLaunchReason,\n    manifest: Updates.manifest ?? undefined,\n    runtimeVersion: Updates.runtimeVersion ?? undefined\n  };\n  // Constructs an UpdateInfo from a manifest\n  var updateFromManifest = manifest => {\n    return {\n      type: _UseUpdatesTypes.UpdateInfoType.NEW,\n      updateId: manifest.id ?? '',\n      createdAt: manifest && 'createdAt' in manifest && manifest.createdAt ? new Date(manifest.createdAt) :\n      // We should never reach this if the manifest is valid and has a commit time,\n      // but leave this in so that createdAt is always defined\n      new Date(0),\n      manifest\n    };\n  };\n  var updateFromRollback = rollback => ({\n    type: _UseUpdatesTypes.UpdateInfoType.ROLLBACK,\n    createdAt: new Date(rollback.commitTime),\n    manifest: undefined,\n    updateId: undefined\n  });\n  // Default useUpdates() state\n  var defaultUseUpdatesState = {\n    isChecking: false,\n    isDownloading: false,\n    isUpdateAvailable: false,\n    isUpdatePending: false\n  };\n  // Transform the useUpdates() state based on native state machine context\n  var reduceUpdatesStateFromContext = (updatesState, context) => {\n    var availableUpdate = context?.latestManifest ? updateFromManifest(context?.latestManifest) : context.rollback ? updateFromRollback(context.rollback) : undefined;\n    var downloadedUpdate = context?.downloadedManifest ? updateFromManifest(context?.downloadedManifest) : context.rollback ? updateFromRollback(context.rollback) : undefined;\n    return {\n      ...updatesState,\n      isUpdateAvailable: context.isUpdateAvailable,\n      isUpdatePending: context.isUpdatePending,\n      isChecking: context.isChecking,\n      isDownloading: context.isDownloading,\n      availableUpdate,\n      downloadedUpdate,\n      checkError: context.checkError,\n      downloadError: context.downloadError,\n      lastCheckForUpdateTimeSinceRestart: context.lastCheckForUpdateTime\n    };\n  };\n});","lineCount":108,"map":[[22,2,4,0,"Object"],[22,8,4,0],[22,9,4,0,"defineProperty"],[22,23,4,0],[22,24,4,0,"exports"],[22,31,4,0],[23,4,4,0,"enumerable"],[23,14,4,0],[24,4,4,0,"get"],[24,7,4,0],[24,18,4,0,"get"],[24,19,4,0],[25,6,4,0],[25,13,4,0,"currentlyRunning"],[25,29,4,0],[26,4,4,0],[27,2,4,0],[28,2,15,0,"Object"],[28,8,15,0],[28,9,15,0,"defineProperty"],[28,23,15,0],[28,24,15,0,"exports"],[28,31,15,0],[29,4,15,0,"enumerable"],[29,14,15,0],[30,4,15,0,"get"],[30,7,15,0],[30,18,15,0,"get"],[30,19,15,0],[31,6,15,0],[31,13,15,0,"updateFromManifest"],[31,31,15,0],[32,4,15,0],[33,2,15,0],[34,2,27,0,"Object"],[34,8,27,0],[34,9,27,0,"defineProperty"],[34,23,27,0],[34,24,27,0,"exports"],[34,31,27,0],[35,4,27,0,"enumerable"],[35,14,27,0],[36,4,27,0,"get"],[36,7,27,0],[36,18,27,0,"get"],[36,19,27,0],[37,6,27,0],[37,13,27,0,"updateFromRollback"],[37,31,27,0],[38,4,27,0],[39,2,27,0],[40,2,34,0,"Object"],[40,8,34,0],[40,9,34,0,"defineProperty"],[40,23,34,0],[40,24,34,0,"exports"],[40,31,34,0],[41,4,34,0,"enumerable"],[41,14,34,0],[42,4,34,0,"get"],[42,7,34,0],[42,18,34,0,"get"],[42,19,34,0],[43,6,34,0],[43,13,34,0,"defaultUseUpdatesState"],[43,35,34,0],[44,4,34,0],[45,2,34,0],[46,2,41,0,"Object"],[46,8,41,0],[46,9,41,0,"defineProperty"],[46,23,41,0],[46,24,41,0,"exports"],[46,31,41,0],[47,4,41,0,"enumerable"],[47,14,41,0],[48,4,41,0,"get"],[48,7,41,0],[48,18,41,0,"get"],[48,19,41,0],[49,6,41,0],[49,13,41,0,"reduceUpdatesStateFromContext"],[49,42,41,0],[50,4,41,0],[51,2,41,0],[52,2,1,0],[52,6,1,0,"_Updates"],[52,14,1,0],[52,17,1,0,"require"],[52,24,1,0],[52,25,1,0,"_dependencyMap"],[52,39,1,0],[53,2,1,0],[53,6,1,0,"Updates"],[53,13,1,0],[53,16,1,0,"_interopNamespace"],[53,33,1,0],[53,34,1,0,"_Updates"],[53,42,1,0],[54,2,2,0],[54,6,2,0,"_UseUpdatesTypes"],[54,22,2,0],[54,25,2,0,"require"],[54,32,2,0],[54,33,2,0,"_dependencyMap"],[54,47,2,0],[55,2,3,0],[56,2,4,7],[56,6,4,13,"currentlyRunning"],[56,22,4,29],[56,25,4,32],[57,4,5,4,"updateId"],[57,12,5,12],[57,14,5,14,"Updates"],[57,21,5,21],[57,22,5,22,"updateId"],[57,30,5,30],[57,34,5,34,"undefined"],[57,43,5,43],[58,4,6,4,"channel"],[58,11,6,11],[58,13,6,13,"Updates"],[58,20,6,20],[58,21,6,21,"channel"],[58,28,6,28],[58,32,6,32,"undefined"],[58,41,6,41],[59,4,7,4,"createdAt"],[59,13,7,13],[59,15,7,15,"Updates"],[59,22,7,22],[59,23,7,23,"createdAt"],[59,32,7,32],[59,36,7,36,"undefined"],[59,45,7,45],[60,4,8,4,"isEmbeddedLaunch"],[60,20,8,20],[60,22,8,22,"Updates"],[60,29,8,29],[60,30,8,30,"isEmbeddedLaunch"],[60,46,8,46],[61,4,9,4,"isEmergencyLaunch"],[61,21,9,21],[61,23,9,23,"Updates"],[61,30,9,30],[61,31,9,31,"isEmergencyLaunch"],[61,48,9,48],[62,4,10,4,"emergencyLaunchReason"],[62,25,10,25],[62,27,10,27,"Updates"],[62,34,10,34],[62,35,10,35,"emergencyLaunchReason"],[62,56,10,56],[63,4,11,4,"manifest"],[63,12,11,12],[63,14,11,14,"Updates"],[63,21,11,21],[63,22,11,22,"manifest"],[63,30,11,30],[63,34,11,34,"undefined"],[63,43,11,43],[64,4,12,4,"runtimeVersion"],[64,18,12,18],[64,20,12,20,"Updates"],[64,27,12,27],[64,28,12,28,"runtimeVersion"],[64,42,12,42],[64,46,12,46,"undefined"],[65,2,13,0],[65,3,13,1],[66,2,14,0],[67,2,15,7],[67,6,15,13,"updateFromManifest"],[67,24,15,31],[67,27,15,35,"manifest"],[67,35,15,43],[67,39,15,48],[68,4,16,4],[68,11,16,11],[69,6,17,8,"type"],[69,10,17,12],[69,12,17,14,"UpdateInfoType"],[69,28,17,28],[69,29,17,28,"UpdateInfoType"],[69,43,17,28],[69,44,17,29,"NEW"],[69,47,17,32],[70,6,18,8,"updateId"],[70,14,18,16],[70,16,18,18,"manifest"],[70,24,18,26],[70,25,18,27,"id"],[70,27,18,29],[70,31,18,33],[70,33,18,35],[71,6,19,8,"createdAt"],[71,15,19,17],[71,17,19,19,"manifest"],[71,25,19,27],[71,29,19,31],[71,40,19,42],[71,44,19,46,"manifest"],[71,52,19,54],[71,56,19,58,"manifest"],[71,64,19,66],[71,65,19,67,"createdAt"],[71,74,19,76],[71,77,20,14],[71,81,20,18,"Date"],[71,85,20,22],[71,86,20,23,"manifest"],[71,94,20,31],[71,95,20,32,"createdAt"],[71,104,20,41],[71,105,20,42],[72,6,21,14],[73,6,22,16],[74,6,23,16],[74,10,23,20,"Date"],[74,14,23,24],[74,15,23,25],[74,16,23,26],[74,17,23,27],[75,6,24,8,"manifest"],[76,4,25,4],[76,5,25,5],[77,2,26,0],[77,3,26,1],[78,2,27,7],[78,6,27,13,"updateFromRollback"],[78,24,27,31],[78,27,27,35,"rollback"],[78,35,27,43],[78,40,27,49],[79,4,28,4,"type"],[79,8,28,8],[79,10,28,10,"UpdateInfoType"],[79,26,28,24],[79,27,28,24,"UpdateInfoType"],[79,41,28,24],[79,42,28,25,"ROLLBACK"],[79,50,28,33],[80,4,29,4,"createdAt"],[80,13,29,13],[80,15,29,15],[80,19,29,19,"Date"],[80,23,29,23],[80,24,29,24,"rollback"],[80,32,29,32],[80,33,29,33,"commitTime"],[80,43,29,43],[80,44,29,44],[81,4,30,4,"manifest"],[81,12,30,12],[81,14,30,14,"undefined"],[81,23,30,23],[82,4,31,4,"updateId"],[82,12,31,12],[82,14,31,14,"undefined"],[83,2,32,0],[83,3,32,1],[83,4,32,2],[84,2,33,0],[85,2,34,7],[85,6,34,13,"defaultUseUpdatesState"],[85,28,34,35],[85,31,34,38],[86,4,35,4,"isChecking"],[86,14,35,14],[86,16,35,16],[86,21,35,21],[87,4,36,4,"isDownloading"],[87,17,36,17],[87,19,36,19],[87,24,36,24],[88,4,37,4,"isUpdateAvailable"],[88,21,37,21],[88,23,37,23],[88,28,37,28],[89,4,38,4,"isUpdatePending"],[89,19,38,19],[89,21,38,21],[90,2,39,0],[90,3,39,1],[91,2,40,0],[92,2,41,7],[92,6,41,13,"reduceUpdatesStateFromContext"],[92,35,41,42],[92,38,41,45,"reduceUpdatesStateFromContext"],[92,39,41,46,"updatesState"],[92,51,41,58],[92,53,41,60,"context"],[92,60,41,67],[92,65,41,72],[93,4,42,4],[93,8,42,10,"availableUpdate"],[93,23,42,25],[93,26,42,28,"context"],[93,33,42,35],[93,35,42,37,"latestManifest"],[93,49,42,51],[93,52,43,10,"updateFromManifest"],[93,70,43,28],[93,71,43,29,"context"],[93,78,43,36],[93,80,43,38,"latestManifest"],[93,94,43,52],[93,95,43,53],[93,98,44,10,"context"],[93,105,44,17],[93,106,44,18,"rollback"],[93,114,44,26],[93,117,45,14,"updateFromRollback"],[93,135,45,32],[93,136,45,33,"context"],[93,143,45,40],[93,144,45,41,"rollback"],[93,152,45,49],[93,153,45,50],[93,156,46,14,"undefined"],[93,165,46,23],[94,4,47,4],[94,8,47,10,"downloadedUpdate"],[94,24,47,26],[94,27,47,29,"context"],[94,34,47,36],[94,36,47,38,"downloadedManifest"],[94,54,47,56],[94,57,48,10,"updateFromManifest"],[94,75,48,28],[94,76,48,29,"context"],[94,83,48,36],[94,85,48,38,"downloadedManifest"],[94,103,48,56],[94,104,48,57],[94,107,49,10,"context"],[94,114,49,17],[94,115,49,18,"rollback"],[94,123,49,26],[94,126,50,14,"updateFromRollback"],[94,144,50,32],[94,145,50,33,"context"],[94,152,50,40],[94,153,50,41,"rollback"],[94,161,50,49],[94,162,50,50],[94,165,51,14,"undefined"],[94,174,51,23],[95,4,52,4],[95,11,52,11],[96,6,53,8],[96,9,53,11,"updatesState"],[96,21,53,23],[97,6,54,8,"isUpdateAvailable"],[97,23,54,25],[97,25,54,27,"context"],[97,32,54,34],[97,33,54,35,"isUpdateAvailable"],[97,50,54,52],[98,6,55,8,"isUpdatePending"],[98,21,55,23],[98,23,55,25,"context"],[98,30,55,32],[98,31,55,33,"isUpdatePending"],[98,46,55,48],[99,6,56,8,"isChecking"],[99,16,56,18],[99,18,56,20,"context"],[99,25,56,27],[99,26,56,28,"isChecking"],[99,36,56,38],[100,6,57,8,"isDownloading"],[100,19,57,21],[100,21,57,23,"context"],[100,28,57,30],[100,29,57,31,"isDownloading"],[100,42,57,44],[101,6,58,8,"availableUpdate"],[101,21,58,23],[102,6,59,8,"downloadedUpdate"],[102,22,59,24],[103,6,60,8,"checkError"],[103,16,60,18],[103,18,60,20,"context"],[103,25,60,27],[103,26,60,28,"checkError"],[103,36,60,38],[104,6,61,8,"downloadError"],[104,19,61,21],[104,21,61,23,"context"],[104,28,61,30],[104,29,61,31,"downloadError"],[104,42,61,44],[105,6,62,8,"lastCheckForUpdateTimeSinceRestart"],[105,40,62,42],[105,42,62,44,"context"],[105,49,62,51],[105,50,62,52,"lastCheckForUpdateTime"],[106,4,63,4],[106,5,63,5],[107,2,64,0],[107,3,64,1],[108,0,64,2],[108,3]],"functionMap":{"names":["<global>","updateFromManifest","updateFromRollback","reduceUpdatesStateFromContext"],"mappings":"AAA;kCCc;CDW;kCEC;EFK;6CGS;CHuB"},"hasCjsExports":false},"type":"js/module"}]}