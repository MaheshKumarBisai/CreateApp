{"dependencies":[{"name":"../vendor/emitter/EventEmitter","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":13,"column":0},"end":{"line":13,"column":58}}],"key":"FSJ8dBSGMPKDnoV5nqp600Oqgzc=","exportNames":["*"],"imports":1}},{"name":"../BatchedBridge/BatchedBridge","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":15,"column":22},"end":{"line":15,"column":63}}],"key":"RVO988+Zv/6E/rt0hBQ7t8lVl4o=","exportNames":["*"],"imports":1}},{"name":"../Utilities/infoLog","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":16,"column":16},"end":{"line":16,"column":47}}],"key":"JOQiliPDxvxpS4qCtoh0JoUHvB4=","exportNames":["*"],"imports":1}},{"name":"./TaskQueue","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":17,"column":18},"end":{"line":17,"column":40}}],"key":"JdVwdRfYYIkBEefq5ZvEtZ/aHHY=","exportNames":["*"],"imports":1}},{"name":"invariant","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":18,"column":18},"end":{"line":18,"column":38}}],"key":"oQpL0Es3H146KnQH9ygFeHrzVP4=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  var _vendorEmitterEventEmitter = require(_dependencyMap[0], \"../vendor/emitter/EventEmitter\");\n  var EventEmitter = _interopDefault(_vendorEmitterEventEmitter);\n  var BatchedBridge = require(_dependencyMap[1], \"../BatchedBridge/BatchedBridge\");\n  var infoLog = require(_dependencyMap[2], \"../Utilities/infoLog\");\n  var TaskQueue = require(_dependencyMap[3], \"./TaskQueue\");\n  var invariant = require(_dependencyMap[4], \"invariant\");\n  var _emitter = new EventEmitter.default();\n  var DEBUG_DELAY = 0;\n  var DEBUG = false;\n  var InteractionManager = {\n    Events: {\n      interactionStart: 'interactionStart',\n      interactionComplete: 'interactionComplete'\n    },\n    runAfterInteractions(task) {\n      var tasks = [];\n      var promise = new Promise(resolve => {\n        _scheduleUpdate();\n        if (task) {\n          tasks.push(task);\n        }\n        tasks.push({\n          run: resolve,\n          name: 'resolve ' + (task && task.name || '?')\n        });\n        _taskQueue.enqueueTasks(tasks);\n      });\n      return {\n        then: promise.then.bind(promise),\n        cancel: function () {\n          _taskQueue.cancelTasks(tasks);\n        }\n      };\n    },\n    createInteractionHandle() {\n      DEBUG && infoLog('InteractionManager: create interaction handle');\n      _scheduleUpdate();\n      var handle = ++_inc;\n      _addInteractionSet.add(handle);\n      return handle;\n    },\n    clearInteractionHandle(handle) {\n      DEBUG && infoLog('InteractionManager: clear interaction handle');\n      invariant(!!handle, 'InteractionManager: Must provide a handle to clear.');\n      _scheduleUpdate();\n      _addInteractionSet.delete(handle);\n      _deleteInteractionSet.add(handle);\n    },\n    addListener: _emitter.addListener.bind(_emitter),\n    setDeadline(deadline) {\n      _deadline = deadline;\n    }\n  };\n  var _interactionSet = new Set();\n  var _addInteractionSet = new Set();\n  var _deleteInteractionSet = new Set();\n  var _taskQueue = new TaskQueue({\n    onMoreTasks: _scheduleUpdate\n  });\n  var _nextUpdateHandle = 0;\n  var _inc = 0;\n  var _deadline = -1;\n  function _scheduleUpdate() {\n    if (!_nextUpdateHandle) {\n      if (_deadline > 0) {\n        _nextUpdateHandle = setTimeout(_processUpdate, 0 + DEBUG_DELAY);\n      } else {\n        _nextUpdateHandle = setImmediate(_processUpdate);\n      }\n    }\n  }\n  function _processUpdate() {\n    _nextUpdateHandle = 0;\n    var interactionCount = _interactionSet.size;\n    _addInteractionSet.forEach(handle => _interactionSet.add(handle));\n    _deleteInteractionSet.forEach(handle => _interactionSet.delete(handle));\n    var nextInteractionCount = _interactionSet.size;\n    if (interactionCount !== 0 && nextInteractionCount === 0) {\n      _emitter.emit(InteractionManager.Events.interactionComplete);\n    } else if (interactionCount === 0 && nextInteractionCount !== 0) {\n      _emitter.emit(InteractionManager.Events.interactionStart);\n    }\n    if (nextInteractionCount === 0) {\n      while (_taskQueue.hasTasksToProcess()) {\n        _taskQueue.processNext();\n        if (_deadline > 0 && BatchedBridge.getEventLoopRunningTime() >= _deadline) {\n          _scheduleUpdate();\n          break;\n        }\n      }\n    }\n    _addInteractionSet.clear();\n    _deleteInteractionSet.clear();\n  }\n  module.exports = InteractionManager;\n});","lineCount":104,"map":[[9,2,13,0],[9,6,13,0,"_vendorEmitterEventEmitter"],[9,32,13,0],[9,35,13,0,"require"],[9,42,13,0],[9,43,13,0,"_dependencyMap"],[9,57,13,0],[10,2,13,0],[10,6,13,0,"EventEmitter"],[10,18,13,0],[10,21,13,0,"_interopDefault"],[10,36,13,0],[10,37,13,0,"_vendorEmitterEventEmitter"],[10,63,13,0],[11,2,15,0],[11,6,15,6,"BatchedBridge"],[11,19,15,19],[11,22,15,22,"require"],[11,29,15,29],[11,30,15,29,"_dependencyMap"],[11,44,15,29],[11,81,15,62],[11,82,15,63],[12,2,16,0],[12,6,16,6,"infoLog"],[12,13,16,13],[12,16,16,16,"require"],[12,23,16,23],[12,24,16,23,"_dependencyMap"],[12,38,16,23],[12,65,16,46],[12,66,16,47],[13,2,17,0],[13,6,17,6,"TaskQueue"],[13,15,17,15],[13,18,17,18,"require"],[13,25,17,25],[13,26,17,25,"_dependencyMap"],[13,40,17,25],[13,58,17,39],[13,59,17,40],[14,2,18,0],[14,6,18,6,"invariant"],[14,15,18,15],[14,18,18,18,"require"],[14,25,18,25],[14,26,18,25,"_dependencyMap"],[14,40,18,25],[14,56,18,37],[14,57,18,38],[15,2,22,0],[15,6,22,6,"_emitter"],[15,14,22,14],[15,17,22,17],[15,21,22,21,"EventEmitter"],[15,33,22,33],[15,34,22,33,"default"],[15,41,22,33],[15,42,25,3],[15,43,25,4],[16,2,27,0],[16,6,27,6,"DEBUG_DELAY"],[16,17,27,20],[16,20,27,23],[16,21,27,24],[17,2,28,0],[17,6,28,6,"DEBUG"],[17,11,28,18],[17,14,28,21],[17,19,28,26],[18,2,79,0],[18,6,79,6,"InteractionManager"],[18,24,79,24],[18,27,79,27],[19,4,80,2,"Events"],[19,10,80,8],[19,12,80,10],[20,6,81,4,"interactionStart"],[20,22,81,20],[20,24,81,22],[20,42,81,40],[21,6,82,4,"interactionComplete"],[21,25,82,23],[21,27,82,25],[22,4,83,2],[22,5,83,3],[23,4,89,2,"runAfterInteractions"],[23,24,89,22,"runAfterInteractions"],[23,25,89,23,"task"],[23,29,89,34],[23,31,96,4],[24,6,97,4],[24,10,97,10,"tasks"],[24,15,97,28],[24,18,97,31],[24,20,97,33],[25,6,98,4],[25,10,98,10,"promise"],[25,17,98,17],[25,20,98,20],[25,24,98,24,"Promise"],[25,31,98,31],[25,32,98,33,"resolve"],[25,39,98,52],[25,43,98,57],[26,8,99,6,"_scheduleUpdate"],[26,23,99,21],[26,24,99,22],[26,25,99,23],[27,8,100,6],[27,12,100,10,"task"],[27,16,100,14],[27,18,100,16],[28,10,101,8,"tasks"],[28,15,101,13],[28,16,101,14,"push"],[28,20,101,18],[28,21,101,19,"task"],[28,25,101,23],[28,26,101,24],[29,8,102,6],[30,8,103,6,"tasks"],[30,13,103,11],[30,14,103,12,"push"],[30,18,103,16],[30,19,103,17],[31,10,104,8,"run"],[31,13,104,11],[31,15,104,13,"resolve"],[31,22,104,20],[32,10,105,8,"name"],[32,14,105,12],[32,16,105,14],[32,26,105,24],[32,30,105,29,"task"],[32,34,105,33],[32,38,105,37,"task"],[32,42,105,41],[32,43,105,42,"name"],[32,47,105,46],[32,51,105,51],[32,54,105,54],[33,8,106,6],[33,9,106,7],[33,10,106,8],[34,8,107,6,"_taskQueue"],[34,18,107,16],[34,19,107,17,"enqueueTasks"],[34,31,107,29],[34,32,107,30,"tasks"],[34,37,107,35],[34,38,107,36],[35,6,108,4],[35,7,108,5],[35,8,108,6],[36,6,109,4],[36,13,109,11],[37,8,111,6,"then"],[37,12,111,10],[37,14,111,12,"promise"],[37,21,111,19],[37,22,111,20,"then"],[37,26,111,24],[37,27,111,25,"bind"],[37,31,111,29],[37,32,111,30,"promise"],[37,39,111,37],[37,40,111,38],[38,8,112,6,"cancel"],[38,14,112,12],[38,16,112,14],[38,25,112,14,"cancel"],[38,26,112,14],[38,28,112,26],[39,10,113,8,"_taskQueue"],[39,20,113,18],[39,21,113,19,"cancelTasks"],[39,32,113,30],[39,33,113,31,"tasks"],[39,38,113,36],[39,39,113,37],[40,8,114,6],[41,6,115,4],[41,7,115,5],[42,4,116,2],[42,5,116,3],[43,4,121,2,"createInteractionHandle"],[43,27,121,25,"createInteractionHandle"],[43,28,121,25],[43,30,121,36],[44,6,122,4,"DEBUG"],[44,11,122,9],[44,15,122,13,"infoLog"],[44,22,122,20],[44,23,122,21],[44,70,122,68],[44,71,122,69],[45,6,123,4,"_scheduleUpdate"],[45,21,123,19],[45,22,123,20],[45,23,123,21],[46,6,124,4],[46,10,124,10,"handle"],[46,16,124,16],[46,19,124,19],[46,21,124,21,"_inc"],[46,25,124,25],[47,6,125,4,"_addInteractionSet"],[47,24,125,22],[47,25,125,23,"add"],[47,28,125,26],[47,29,125,27,"handle"],[47,35,125,33],[47,36,125,34],[48,6,126,4],[48,13,126,11,"handle"],[48,19,126,17],[49,4,127,2],[49,5,127,3],[50,4,132,2,"clearInteractionHandle"],[50,26,132,24,"clearInteractionHandle"],[50,27,132,25,"handle"],[50,33,132,39],[50,35,132,41],[51,6,133,4,"DEBUG"],[51,11,133,9],[51,15,133,13,"infoLog"],[51,22,133,20],[51,23,133,21],[51,69,133,67],[51,70,133,68],[52,6,134,4,"invariant"],[52,15,134,13],[52,16,134,14],[52,17,134,15],[52,18,134,16,"handle"],[52,24,134,22],[52,26,134,24],[52,79,134,77],[52,80,134,78],[53,6,135,4,"_scheduleUpdate"],[53,21,135,19],[53,22,135,20],[53,23,135,21],[54,6,136,4,"_addInteractionSet"],[54,24,136,22],[54,25,136,23,"delete"],[54,31,136,29],[54,32,136,30,"handle"],[54,38,136,36],[54,39,136,37],[55,6,137,4,"_deleteInteractionSet"],[55,27,137,25],[55,28,137,26,"add"],[55,31,137,29],[55,32,137,30,"handle"],[55,38,137,36],[55,39,137,37],[56,4,138,2],[56,5,138,3],[57,4,141,2,"addListener"],[57,15,141,13],[57,17,141,16,"_emitter"],[57,25,141,24],[57,26,141,25,"addListener"],[57,37,141,36],[57,38,141,37,"bind"],[57,42,141,41],[57,43,141,42,"_emitter"],[57,51,141,50],[57,52,141,64],[58,4,148,2,"setDeadline"],[58,15,148,13,"setDeadline"],[58,16,148,14,"deadline"],[58,24,148,30],[58,26,148,32],[59,6,149,4,"_deadline"],[59,15,149,13],[59,18,149,16,"deadline"],[59,26,149,24],[60,4,150,2],[61,2,151,0],[61,3,151,1],[62,2,153,0],[62,6,153,6,"_interactionSet"],[62,21,153,21],[62,24,153,24],[62,28,153,28,"Set"],[62,31,153,31],[62,32,153,49],[62,33,153,50],[63,2,154,0],[63,6,154,6,"_addInteractionSet"],[63,24,154,24],[63,27,154,27],[63,31,154,31,"Set"],[63,34,154,34],[63,35,154,52],[63,36,154,53],[64,2,155,0],[64,6,155,6,"_deleteInteractionSet"],[64,27,155,27],[64,30,155,30],[64,34,155,34,"Set"],[64,37,155,37],[64,38,155,46],[64,39,155,47],[65,2,156,0],[65,6,156,6,"_taskQueue"],[65,16,156,16],[65,19,156,19],[65,23,156,23,"TaskQueue"],[65,32,156,32],[65,33,156,33],[66,4,156,34,"onMoreTasks"],[66,15,156,45],[66,17,156,47,"_scheduleUpdate"],[67,2,156,62],[67,3,156,63],[67,4,156,64],[68,2,157,0],[68,6,157,4,"_nextUpdateHandle"],[68,23,157,45],[68,26,157,48],[68,27,157,49],[69,2,158,0],[69,6,158,4,"_inc"],[69,10,158,8],[69,13,158,11],[69,14,158,12],[70,2,159,0],[70,6,159,4,"_deadline"],[70,15,159,13],[70,18,159,16],[70,19,159,17],[70,20,159,18],[71,2,164,0],[71,11,164,9,"_scheduleUpdate"],[71,26,164,24,"_scheduleUpdate"],[71,27,164,24],[71,29,164,27],[72,4,165,2],[72,8,165,6],[72,9,165,7,"_nextUpdateHandle"],[72,26,165,24],[72,28,165,26],[73,6,166,4],[73,10,166,8,"_deadline"],[73,19,166,17],[73,22,166,20],[73,23,166,21],[73,25,166,23],[74,8,167,6,"_nextUpdateHandle"],[74,25,167,23],[74,28,167,26,"setTimeout"],[74,38,167,36],[74,39,167,37,"_processUpdate"],[74,53,167,51],[74,55,167,53],[74,56,167,54],[74,59,167,57,"DEBUG_DELAY"],[74,70,167,68],[74,71,167,69],[75,6,168,4],[75,7,168,5],[75,13,168,11],[76,8,169,6,"_nextUpdateHandle"],[76,25,169,23],[76,28,169,26,"setImmediate"],[76,40,169,38],[76,41,169,39,"_processUpdate"],[76,55,169,53],[76,56,169,54],[77,6,170,4],[78,4,171,2],[79,2,172,0],[80,2,177,0],[80,11,177,9,"_processUpdate"],[80,25,177,23,"_processUpdate"],[80,26,177,23],[80,28,177,26],[81,4,178,2,"_nextUpdateHandle"],[81,21,178,19],[81,24,178,22],[81,25,178,23],[82,4,180,2],[82,8,180,8,"interactionCount"],[82,24,180,24],[82,27,180,27,"_interactionSet"],[82,42,180,42],[82,43,180,43,"size"],[82,47,180,47],[83,4,181,2,"_addInteractionSet"],[83,22,181,20],[83,23,181,21,"forEach"],[83,30,181,28],[83,31,181,29,"handle"],[83,37,181,35],[83,41,181,39,"_interactionSet"],[83,56,181,54],[83,57,181,55,"add"],[83,60,181,58],[83,61,181,59,"handle"],[83,67,181,65],[83,68,181,66],[83,69,181,67],[84,4,182,2,"_deleteInteractionSet"],[84,25,182,23],[84,26,182,24,"forEach"],[84,33,182,31],[84,34,182,32,"handle"],[84,40,182,38],[84,44,182,42,"_interactionSet"],[84,59,182,57],[84,60,182,58,"delete"],[84,66,182,64],[84,67,182,65,"handle"],[84,73,182,71],[84,74,182,72],[84,75,182,73],[85,4,183,2],[85,8,183,8,"nextInteractionCount"],[85,28,183,28],[85,31,183,31,"_interactionSet"],[85,46,183,46],[85,47,183,47,"size"],[85,51,183,51],[86,4,185,2],[86,8,185,6,"interactionCount"],[86,24,185,22],[86,29,185,27],[86,30,185,28],[86,34,185,32,"nextInteractionCount"],[86,54,185,52],[86,59,185,57],[86,60,185,58],[86,62,185,60],[87,6,187,4,"_emitter"],[87,14,187,12],[87,15,187,13,"emit"],[87,19,187,17],[87,20,187,18,"InteractionManager"],[87,38,187,36],[87,39,187,37,"Events"],[87,45,187,43],[87,46,187,44,"interactionComplete"],[87,65,187,63],[87,66,187,64],[88,4,188,2],[88,5,188,3],[88,11,188,9],[88,15,188,13,"interactionCount"],[88,31,188,29],[88,36,188,34],[88,37,188,35],[88,41,188,39,"nextInteractionCount"],[88,61,188,59],[88,66,188,64],[88,67,188,65],[88,69,188,67],[89,6,190,4,"_emitter"],[89,14,190,12],[89,15,190,13,"emit"],[89,19,190,17],[89,20,190,18,"InteractionManager"],[89,38,190,36],[89,39,190,37,"Events"],[89,45,190,43],[89,46,190,44,"interactionStart"],[89,62,190,60],[89,63,190,61],[90,4,191,2],[91,4,194,2],[91,8,194,6,"nextInteractionCount"],[91,28,194,26],[91,33,194,31],[91,34,194,32],[91,36,194,34],[92,6,195,4],[92,13,195,11,"_taskQueue"],[92,23,195,21],[92,24,195,22,"hasTasksToProcess"],[92,41,195,39],[92,42,195,40],[92,43,195,41],[92,45,195,43],[93,8,196,6,"_taskQueue"],[93,18,196,16],[93,19,196,17,"processNext"],[93,30,196,28],[93,31,196,29],[93,32,196,30],[94,8,197,6],[94,12,198,8,"_deadline"],[94,21,198,17],[94,24,198,20],[94,25,198,21],[94,29,199,8,"BatchedBridge"],[94,42,199,21],[94,43,199,22,"getEventLoopRunningTime"],[94,66,199,45],[94,67,199,46],[94,68,199,47],[94,72,199,51,"_deadline"],[94,81,199,60],[94,83,200,8],[95,10,202,8,"_scheduleUpdate"],[95,25,202,23],[95,26,202,24],[95,27,202,25],[96,10,203,8],[97,8,204,6],[98,6,205,4],[99,4,206,2],[100,4,207,2,"_addInteractionSet"],[100,22,207,20],[100,23,207,21,"clear"],[100,28,207,26],[100,29,207,27],[100,30,207,28],[101,4,208,2,"_deleteInteractionSet"],[101,25,208,23],[101,26,208,24,"clear"],[101,31,208,29],[101,32,208,30],[101,33,208,31],[102,2,209,0],[103,2,211,0,"module"],[103,8,211,6],[103,9,211,7,"exports"],[103,16,211,14],[103,19,211,17,"InteractionManager"],[103,37,211,35],[104,0,211,36],[104,3]],"functionMap":{"names":["<global>","runAfterInteractions","Promise$argument_0","cancel","createInteractionHandle","clearInteractionHandle","setDeadline","_scheduleUpdate","_processUpdate","_addInteractionSet.forEach$argument_0","_deleteInteractionSet.forEach$argument_0"],"mappings":"AAA;ECwF;gCCS;KDU;cEI;OFE;GDE;EIK;GJM;EKK;GLM;EMU;GNE;AOc;CPQ;AQK;6BCI,qCD;gCEC,wCF;CR2B"},"hasCjsExports":true},"type":"js/module"}]}