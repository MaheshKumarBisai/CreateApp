{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":89},"end":{"line":5,"column":31,"index":120}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"./NavigationBuilderContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":122},"end":{"line":9,"column":36,"index":222}}],"key":"KFIEweWhugyJmWZL0YQ42pa68TE=","exportNames":["*"],"imports":1}},{"name":"./NavigationRouteContext","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":10,"column":0,"index":223},"end":{"line":10,"column":62,"index":285}}],"key":"I5Ob2ePenkMlCuG37rE0R3UVd48=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      var d = Object.getOwnPropertyDescriptor(e, k);\n      Object.defineProperty(n, k, d.get ? d : {\n        enumerable: true,\n        get: function () {\n          return e[k];\n        }\n      });\n    });\n    n.default = e;\n    return n;\n  }\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return useOnPreventRemove;\n    }\n  });\n  Object.defineProperty(exports, \"shouldPreventRemove\", {\n    enumerable: true,\n    get: function () {\n      return shouldPreventRemove;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var React = _interopNamespace(_react);\n  var _NavigationBuilderContext = require(_dependencyMap[1], \"./NavigationBuilderContext\");\n  var NavigationBuilderContext = _interopDefault(_NavigationBuilderContext);\n  var _NavigationRouteContext = require(_dependencyMap[2], \"./NavigationRouteContext\");\n  var NavigationRouteContext = _interopDefault(_NavigationRouteContext);\n  var VISITED_ROUTE_KEYS = Symbol('VISITED_ROUTE_KEYS');\n  var shouldPreventRemove = (emitter, beforeRemoveListeners, currentRoutes, nextRoutes, action) => {\n    var nextRouteKeys = nextRoutes.map(route => route.key);\n\n    // Call these in reverse order so last screens handle the event first\n    var removedRoutes = currentRoutes.filter(route => !nextRouteKeys.includes(route.key)).reverse();\n    var visitedRouteKeys =\n    // @ts-expect-error: add this property to mark that we've already emitted this action\n    action[VISITED_ROUTE_KEYS] ?? new Set();\n    var beforeRemoveAction = {\n      ...action,\n      [VISITED_ROUTE_KEYS]: visitedRouteKeys\n    };\n    for (var route of removedRoutes) {\n      if (visitedRouteKeys.has(route.key)) {\n        // Skip if we've already emitted this action for this screen\n        continue;\n      }\n\n      // First, we need to check if any child screens want to prevent it\n      var isPrevented = beforeRemoveListeners[route.key]?.(beforeRemoveAction);\n      if (isPrevented) {\n        return true;\n      }\n      visitedRouteKeys.add(route.key);\n      var event = emitter.emit({\n        type: 'beforeRemove',\n        target: route.key,\n        data: {\n          action: beforeRemoveAction\n        },\n        canPreventDefault: true\n      });\n      if (event.defaultPrevented) {\n        return true;\n      }\n    }\n    return false;\n  };\n  function useOnPreventRemove(_ref) {\n    var getState = _ref.getState,\n      emitter = _ref.emitter,\n      beforeRemoveListeners = _ref.beforeRemoveListeners;\n    var _React$useContext = React.useContext(NavigationBuilderContext.default),\n      addKeyedListener = _React$useContext.addKeyedListener;\n    var route = React.useContext(NavigationRouteContext.default);\n    var routeKey = route?.key;\n    React.useEffect(() => {\n      if (routeKey) {\n        return addKeyedListener?.('beforeRemove', routeKey, action => {\n          var state = getState();\n          return shouldPreventRemove(emitter, beforeRemoveListeners, state.routes, [], action);\n        });\n      }\n    }, [addKeyedListener, beforeRemoveListeners, emitter, getState, routeKey]);\n  }\n});","lineCount":101,"map":[[27,2,75,15,"Object"],[27,8,75,15],[27,9,75,15,"defineProperty"],[27,23,75,15],[27,24,75,15,"exports"],[27,31,75,15],[28,4,75,15,"enumerable"],[28,14,75,15],[29,4,75,15,"get"],[29,7,75,15],[29,18,75,15,"get"],[29,19,75,15],[30,6,75,15],[30,13,75,15,"useOnPreventRemove"],[30,31,75,15],[31,4,75,15],[32,2,75,15],[33,2,22,0,"Object"],[33,8,22,0],[33,9,22,0,"defineProperty"],[33,23,22,0],[33,24,22,0,"exports"],[33,31,22,0],[34,4,22,0,"enumerable"],[34,14,22,0],[35,4,22,0,"get"],[35,7,22,0],[35,18,22,0,"get"],[35,19,22,0],[36,6,22,0],[36,13,22,0,"shouldPreventRemove"],[36,32,22,0],[37,4,22,0],[38,2,22,0],[39,2,5,0],[39,6,5,0,"_react"],[39,12,5,0],[39,15,5,0,"require"],[39,22,5,0],[39,23,5,0,"_dependencyMap"],[39,37,5,0],[40,2,5,0],[40,6,5,0,"React"],[40,11,5,0],[40,14,5,0,"_interopNamespace"],[40,31,5,0],[40,32,5,0,"_react"],[40,38,5,0],[41,2,7,0],[41,6,7,0,"_NavigationBuilderContext"],[41,31,7,0],[41,34,7,0,"require"],[41,41,7,0],[41,42,7,0,"_dependencyMap"],[41,56,7,0],[42,2,7,0],[42,6,7,0,"NavigationBuilderContext"],[42,30,7,0],[42,33,7,0,"_interopDefault"],[42,48,7,0],[42,49,7,0,"_NavigationBuilderContext"],[42,74,7,0],[43,2,10,0],[43,6,10,0,"_NavigationRouteContext"],[43,29,10,0],[43,32,10,0,"require"],[43,39,10,0],[43,40,10,0,"_dependencyMap"],[43,54,10,0],[44,2,10,0],[44,6,10,0,"NavigationRouteContext"],[44,28,10,0],[44,31,10,0,"_interopDefault"],[44,46,10,0],[44,47,10,0,"_NavigationRouteContext"],[44,70,10,0],[45,2,20,0],[45,6,20,6,"VISITED_ROUTE_KEYS"],[45,24,20,24],[45,27,20,27,"Symbol"],[45,33,20,33],[45,34,20,34],[45,54,20,54],[45,55,20,55],[46,2,22,7],[46,6,22,13,"shouldPreventRemove"],[46,25,22,32],[46,28,22,35,"shouldPreventRemove"],[46,29,23,2,"emitter"],[46,36,23,52],[46,38,24,2,"beforeRemoveListeners"],[46,59,24,78],[46,61,25,2,"currentRoutes"],[46,74,25,34],[46,76,26,2,"nextRoutes"],[46,86,26,44],[46,88,27,2,"action"],[46,94,27,26],[46,99,28,5],[47,4,29,2],[47,8,29,8,"nextRouteKeys"],[47,21,29,21],[47,24,29,24,"nextRoutes"],[47,34,29,34],[47,35,29,35,"map"],[47,38,29,38],[47,39,29,40,"route"],[47,44,29,45],[47,48,29,50,"route"],[47,53,29,55],[47,54,29,56,"key"],[47,57,29,59],[47,58,29,60],[49,4,31,2],[50,4,32,2],[50,8,32,8,"removedRoutes"],[50,21,32,21],[50,24,32,24,"currentRoutes"],[50,37,32,37],[50,38,33,5,"filter"],[50,44,33,11],[50,45,33,13,"route"],[50,50,33,18],[50,54,33,23],[50,55,33,24,"nextRouteKeys"],[50,68,33,37],[50,69,33,38,"includes"],[50,77,33,46],[50,78,33,47,"route"],[50,83,33,52],[50,84,33,53,"key"],[50,87,33,56],[50,88,33,57],[50,89,33,58],[50,90,34,5,"reverse"],[50,97,34,12],[50,98,34,13],[50,99,34,14],[51,4,36,2],[51,8,36,8,"visitedRouteKeys"],[51,24,36,37],[52,4,37,4],[53,4,38,4,"action"],[53,10,38,10],[53,11,38,11,"VISITED_ROUTE_KEYS"],[53,29,38,29],[53,30,38,30],[53,34,38,34],[53,38,38,38,"Set"],[53,41,38,41],[53,42,38,50],[53,43,38,51],[54,4,40,2],[54,8,40,8,"beforeRemoveAction"],[54,26,40,26],[54,29,40,29],[55,6,41,4],[55,9,41,7,"action"],[55,15,41,13],[56,6,42,4],[56,7,42,5,"VISITED_ROUTE_KEYS"],[56,25,42,23],[56,28,42,26,"visitedRouteKeys"],[57,4,43,2],[57,5,43,3],[58,4,45,2],[58,9,45,7],[58,13,45,13,"route"],[58,18,45,18],[58,22,45,22,"removedRoutes"],[58,35,45,35],[58,37,45,37],[59,6,46,4],[59,10,46,8,"visitedRouteKeys"],[59,26,46,24],[59,27,46,25,"has"],[59,30,46,28],[59,31,46,29,"route"],[59,36,46,34],[59,37,46,35,"key"],[59,40,46,38],[59,41,46,39],[59,43,46,41],[60,8,47,6],[61,8,48,6],[62,6,49,4],[64,6,51,4],[65,6,52,4],[65,10,52,10,"isPrevented"],[65,21,52,21],[65,24,52,24,"beforeRemoveListeners"],[65,45,52,45],[65,46,52,46,"route"],[65,51,52,51],[65,52,52,52,"key"],[65,55,52,55],[65,56,52,56],[65,59,52,59,"beforeRemoveAction"],[65,77,52,77],[65,78,52,78],[66,6,54,4],[66,10,54,8,"isPrevented"],[66,21,54,19],[66,23,54,21],[67,8,55,6],[67,15,55,13],[67,19,55,17],[68,6,56,4],[69,6,58,4,"visitedRouteKeys"],[69,22,58,20],[69,23,58,21,"add"],[69,26,58,24],[69,27,58,25,"route"],[69,32,58,30],[69,33,58,31,"key"],[69,36,58,34],[69,37,58,35],[70,6,60,4],[70,10,60,10,"event"],[70,15,60,15],[70,18,60,18,"emitter"],[70,25,60,25],[70,26,60,26,"emit"],[70,30,60,30],[70,31,60,31],[71,8,61,6,"type"],[71,12,61,10],[71,14,61,12],[71,28,61,26],[72,8,62,6,"target"],[72,14,62,12],[72,16,62,14,"route"],[72,21,62,19],[72,22,62,20,"key"],[72,25,62,23],[73,8,63,6,"data"],[73,12,63,10],[73,14,63,12],[74,10,63,14,"action"],[74,16,63,20],[74,18,63,22,"beforeRemoveAction"],[75,8,63,41],[75,9,63,42],[76,8,64,6,"canPreventDefault"],[76,25,64,23],[76,27,64,25],[77,6,65,4],[77,7,65,5],[77,8,65,6],[78,6,67,4],[78,10,67,8,"event"],[78,15,67,13],[78,16,67,14,"defaultPrevented"],[78,32,67,30],[78,34,67,32],[79,8,68,6],[79,15,68,13],[79,19,68,17],[80,6,69,4],[81,4,70,2],[82,4,72,2],[82,11,72,9],[82,16,72,14],[83,2,73,0],[83,3,73,1],[84,2,75,15],[84,11,75,24,"useOnPreventRemove"],[84,29,75,42,"useOnPreventRemove"],[84,30,75,42,"_ref"],[84,34,75,42],[84,36,79,12],[85,4,79,12],[85,8,76,2,"getState"],[85,16,76,10],[85,19,76,10,"_ref"],[85,23,76,10],[85,24,76,2,"getState"],[85,32,76,10],[86,6,77,2,"emitter"],[86,13,77,9],[86,16,77,9,"_ref"],[86,20,77,9],[86,21,77,2,"emitter"],[86,28,77,9],[87,6,78,2,"beforeRemoveListeners"],[87,27,78,23],[87,30,78,23,"_ref"],[87,34,78,23],[87,35,78,2,"beforeRemoveListeners"],[87,56,78,23],[88,4,80,2],[88,8,80,2,"_React$useContext"],[88,25,80,2],[88,28,80,31,"React"],[88,33,80,36],[88,34,80,37,"useContext"],[88,44,80,47],[88,45,80,48,"NavigationBuilderContext"],[88,69,80,72],[88,70,80,72,"default"],[88,77,80,72],[88,78,80,73],[89,6,80,10,"addKeyedListener"],[89,22,80,26],[89,25,80,26,"_React$useContext"],[89,42,80,26],[89,43,80,10,"addKeyedListener"],[89,59,80,26],[90,4,81,2],[90,8,81,8,"route"],[90,13,81,13],[90,16,81,16,"React"],[90,21,81,21],[90,22,81,22,"useContext"],[90,32,81,32],[90,33,81,33,"NavigationRouteContext"],[90,55,81,55],[90,56,81,55,"default"],[90,63,81,55],[90,64,81,56],[91,4,82,2],[91,8,82,8,"routeKey"],[91,16,82,16],[91,19,82,19,"route"],[91,24,82,24],[91,26,82,26,"key"],[91,29,82,29],[92,4,84,2,"React"],[92,9,84,7],[92,10,84,8,"useEffect"],[92,19,84,17],[92,20,84,18],[92,26,84,24],[93,6,85,4],[93,10,85,8,"routeKey"],[93,18,85,16],[93,20,85,18],[94,8,86,6],[94,15,86,13,"addKeyedListener"],[94,31,86,29],[94,34,86,32],[94,48,86,46],[94,50,86,48,"routeKey"],[94,58,86,56],[94,60,86,59,"action"],[94,66,86,65],[94,70,86,70],[95,10,87,8],[95,14,87,14,"state"],[95,19,87,19],[95,22,87,22,"getState"],[95,30,87,30],[95,31,87,31],[95,32,87,32],[96,10,89,8],[96,17,89,15,"shouldPreventRemove"],[96,36,89,34],[96,37,90,10,"emitter"],[96,44,90,17],[96,46,91,10,"beforeRemoveListeners"],[96,67,91,31],[96,69,92,10,"state"],[96,74,92,15],[96,75,92,16,"routes"],[96,81,92,22],[96,83,93,10],[96,85,93,12],[96,87,94,10,"action"],[96,93,95,8],[96,94,95,9],[97,8,96,6],[97,9,96,7],[97,10,96,8],[98,6,97,4],[99,4,98,2],[99,5,98,3],[99,7,98,5],[99,8,98,6,"addKeyedListener"],[99,24,98,22],[99,26,98,24,"beforeRemoveListeners"],[99,47,98,45],[99,49,98,47,"emitter"],[99,56,98,54],[99,58,98,56,"getState"],[99,66,98,64],[99,68,98,66,"routeKey"],[99,76,98,74],[99,77,98,75],[99,78,98,76],[100,2,99,0],[101,0,99,1],[101,3]],"functionMap":{"names":["<global>","shouldPreventRemove","nextRoutes.map$argument_0","currentRoutes.filter$argument_0","useOnPreventRemove","React.useEffect$argument_0","addKeyedListener$argument_2"],"mappings":"AAA;mCCqB;uCCO,oBD;YEI,6CF;CDwC;eIE;kBCS;0DCE;ODU;GDE;CJC"},"hasCjsExports":false},"type":"js/module"}]}